<!-- The home page of the IMC Console -->

<!-- Ensures that the navivaation bar and other things from base.html are included -->
{% extends 'base.html' %}

<!-- The title of the page (Home) -->
{% block title %}
    Home
{% endblock %}

<!-- Add extra information to the head of the page -->
{% block extra_head %}
    <link rel="stylesheet" href="/static/styles/styles_index.css">
{% endblock %}

<!-- Content specific to this page -->
{% block content %}
<div class="index-container">
    <!-- If the user is not logged in, show a login link. If they are logged in, show a welcome message. -->
    {% if not current_user.is_authenticated %}
        <style>
            .index-container {
                display: flex;
                align-items: center;
            }
        </style>
        <div class="index-hero">
            <img src="{{ url_for('static', filename='logo_IMC.svg') }}" alt="IMC Logo" class="index-hero-logo">
            <h1 class="index-hero-text">Console</h1>
            <br>
            <h3>Please <span><a href="/login">login</a></span> to access the console.</h3>
        </div>
    {% else %}
        <div class="index-header">
            <h2>Welcome, {{ current_user.name }}</h2>
            <h4>to the IMC Console</h4>
        </div>

        <hr>

        <div class="upcoming-events-container">
            <div class="upcoming-events-header">
                <h3 style="margin-bottom: 0">Upcoming All-Staff Events</h3>
                <a href="{{ get_gcal_url(constants.MAIN_IMC_GCAL_ID) }}">View the full calendar</a>
            </div>
            <!-- If there are no upcoming events, display a message -->
            {% if not upcoming_events %}
                <div class="upcoming-event" style="align-items: center; text-align: center;">
                    <p style="margin-bottom: 0;">There are no all-staff events within the next 14 days</p>
                </div>
            
            <!-- Otherwise, show all of the events in the next 14 days -->
            {% else %}
                <!-- Loop through all of the upcoming events and display them -->
                {% for event in upcoming_events %}
                    <div class="upcoming-event">
                        <h4>{{ event.title }}</h4>
                        <p class="upcoming-event-text"><span>{{ event.start }}{% if event.location %} at {{ event.location }}{% endif%}</span></p>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <hr>

        <div class="tools-container">
            <div class="tools-header">
                <h3 style="margin-bottom: 0">Employee Tools</h3>
            </div>
            {% for category, tools_list in tools.items() %}
                <hr class="tool-category-divider">
                <h4>{{ category }}</h4>
                <div class="tool-category">
                    {% for tool in tools_list %}
                        <a href="{{ tool.url }}"{% if tool.new_tab %}target="_blank"{% endif %} class="tool-item-container">
                            <div class="tool-item-header">
                                <i class="{{ tool.icon }} tool-item-icon"></i>
                                <h4 style="margin-bottom: 0;">
                                    {{ tool.name }}
                                </h4>
                            </div>
                            <p style="margin-bottom: 0;">
                                {{ tool.description }}
                            </p>
                        </a>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>

    {% endif %}
    
</div>

{% endblock %}
